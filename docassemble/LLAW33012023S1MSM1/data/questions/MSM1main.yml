---
include:
  - Migration_Loops.yml
  - Prototype_willsestates.yml
  - Migration_questions.yml
---
mandatory: True
#This is the initial welcome screen that explains what the application does
question: Welcome to MSM Legal!
subquestion: |
    This will give [MSM Legal](https://www.msmlegal.com.au/) insight into your situation and assist in finding the best lawyer to help you.
    
    **Disclaimier - do we need one - what will it say?**
buttons:
  - Continue: continue
  - Exit: exit
    url: https://www.msmlegal.com.au/
---
#This is the code screen that drives 
mandatory: True
code: |
  if ESLquestion == 'Yes':
    language
    interpreterQuestion
  if legalIssue == 'Wills and Estates':
    WE_final_screen
  elif legalIssue == 'Migration':
    M_final_screen
---
#This is the ESL question
question: Do you speak a Language other than English at home?
fields:
  - Do you speak a language other than english at home?: ESLquestion
    datatype: radio
    choices:
      - Yes
      - No
---
question: Do you require a translator?
fields:
  - Which language do you speak?: language
  - Do you require an interpreter for your meeting with MSM Legal?: interpreterQuestion
    datatype: radio
    choices:
      - Yes 
      - No 
---
#This is the Langauge
#question: |
#  Do you speak a Language other than English at home?
#fields:
#  - Language: language
---
#This is the interpreter question
#question: Do you require an Interpreter?
#subquestion: |
#  **Is an interpreter required for Phone or In-Person meetings with MSM Legal?**
#fields:
#  - no label: interpreterQuestion
#    datatype: radio
#    choices:
#      - "Yes"
#      - "No"
---
#This asks what legal issue the user has
question: What is your legal issue?
subquestion: |
  **Is it Migration or Wills and Estates related?**
field: legalIssue
buttons:
  - "Migration"
  - "Wills and Estates"
---
default screen parts:
  under: |
    % if show_save_resume_message:
    [Save and resume later](${ url_action('save_and_resume') })
    % endif
---
mandatory: True
code: |
  target = 'normal'
  show_save_resume_message = True
  multi_user = True
---
mandatory: True
scan for variables: False
code: |
  if target == 'save_and_resume':
    if wants_email:
      if email_sent:
        log("We sent an e-mail to your e-mail address.", "info")
      else:
        log("There was a problem with e-mailing.", "danger")
      show_save_resume_message = False
    undefine('wants_email')
    undefine('email_sent')
    target = 'normal'
  M_final_screen or WE_final_screen
---
event: save_and_resume
code: |
  target = 'save_and_resume'
---
code: |
  send_email(to=user_email_address, template=save_resume_template)
  email_sent = True
---
question: |
  How to resume your interview later
subquestion: |
  If you want to resume your interview later, we can
  e-mail you a link that you can click on to resume
  your interview at a later time.
fields:
  - no label: wants_email
    input type: radio
    choices:
      - "Ok, e-mail me": True
      - "No thanks": False
    default: True
  - E-mail address: user_email_address
    datatype: email
    show if: wants_email
under: ""
---
template: save_resume_template
subject: |
  Your interview
content: |
  To resume your interview, 
  [click here](${ interview_url() }).
---