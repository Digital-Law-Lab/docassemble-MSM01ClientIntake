---
#This will run the Migration questions
event: M_final_screen
question: Thank you for using the MSM Online Client Intake Form
subquestion: |
  Thank you for using the MSM Online Client Intake Form!
  
  Your responses are shown in the table below.
  
  - If you have made a mistake, click the **Restart** button to fix the mistake.
  
  - If you are satisfied with the information you have provided, click **Submit and Exit** and you will be contacted as soon as possible to organise an appointment time with a member of the MSM Legal Team. A copy of your responses will also be sent to the email address you have provided.
  
    Questions|Main Applicant's Details
    ---------------|-------------
    %if userMainApp == 'Yes':
    Full Name | ${ M_first_name }${ M_last_name }
    Date of Birth | ${ M_DOB }
    Email Address | ${ M_email_address }
    Phone Number | ${ M_phone_number }
    Visa Status | ${ M_aus_visa }
    Visa Type | ${ M_visa_type }
    Purpose for stay in Australia | ${ M_reason_stay }
    %elif userMainApp == 'No':
    Full Name | ${ Main_app_name }
    Date of Birth | ${ Main_app_DOB }
    Email Address | ${ Main_app_email_address }
    Phone Number | ${ Main_app_phone_number }
    Visa Status | ${ M_aus_visa }
    Visa Type | ${ M_visa_type }
    Purpose for stay in Australia | ${ M_reason_stay }
    %endif
  
    Questions|Your Detail's
    ------------|-------------
    %if userMainApp == 'No':
    Full Name | ${ M_first_name } ${ M_last_name }
    Date of Birth | ${ M_DOB }
    Email Address | ${ M_email_address }
    Phone Number | ${ M_phone_number }
    %endif

  % if M_email_sent_ok:
  Once again, thank you for contacting MSM Legal, and we look forward to speaking with you soon. 
  % else:
  There was a problem sending the e-mail.
  % endif
buttons:
  - Submit and Exit: exit
    url: https://www.msmlegal.com.au/
  - Restart: restart
---
#This is the first question of the migration path - asks if the user is the main applicant
question: Who is the Main Applicant?
subquestion: |
  **${ M_first_name }, are you the Main Applicant?**
field: userMainApp
buttons:
  - "No"
  - "Yes"
---
#This screen shall ask if there are any family members applying/migrating with the user - this is where the loop may come in handy

---
#If there are family members, this screen will ask for their details (including visa status and purpose in Australia)

---
#

---
question: Personal Information
subquestion: |
  Please fill out your personal information for your migration application.
fields:
  - First Name: M_first_name
  - Last Name: M_last_name
  - Date of Birth: M_DOB
    datatype: date
  - Email Address: M_email_address
    datatype: email
  - Is the best contact mobile based in Australia?: M_phone_international
    datatype: noyesradio
    default: False
  - What country is associated with the best contact phone number?: M_phone_country
    code: countries_list()
    show if: M_phone_international
  - What is the best contact phone number?: M_phone_number
validation code: |
  if M_phone_international:
    if not phone_number_is_valid(M_phone_number, country=M_phone_country):
      validation_error('Please enter a valid phone number for ' + country_name(M_phone_country) + '.', field='M_phone_number')
  else:
    if not phone_number_is_valid(M_phone_number):
      validation_error('Please enter a valid phone number.', field='M_phone_number')
---
code: |
  if not M_phone_international:
    M_phone_country = 'Aus'
---
code: |
  M_email_sent_ok = send_email(to=M_email_address,bcc=['shai.barboza@flinders.edu.au'], template=M_notification, attachments=[MSM_Legal_Answer_Template_Migration])
---
template: M_notification
subject: |
  MSM Legal Client Intake Form for ${ M_first_name } ${ M_last_name }.
content: |
  Hello ${ M_first_name } ${ M_last_name }, 
  
  Thank you for contacting MSM Legal regarding your matter. We have received your enquiry and one of our team members will be in touch shortly.
  
  For your reference, please find attached a copy of what we have recieved.
  
  Should you have any questions or concerns, please do not hesitate to contact us on (08) 81615088 or via email at dh@msmlegal.com.au
  
  Kind Regards, 
  
  MSM Legal
---
attachment: 
  - name: legal answers 
    filename: ${ M_first_name } ${ M_last_name } Answers
    variable name: MSM_Legal_Answer_Template_Migration
    description: | 
      contains the answers entered by the user
    docx template file: MSM_Legal_Answer_Template_Migration.docx
    valid formats: 
      - pdf
---
question: Main Applicant's Personal Information
subquestion: |
  Please fill out the Main Applicant's personal information below.
fields:
  - The Main Applicant's Name: Main_app_name
  - The Main Applicant's Date of Birth: Main_app_DOB
    datatype: date
  - The Main Applicant's Email Address: Main_app_email_address
    datatype: email
  - Is the best contact mobile based in Australia?: Main_app_phone_international
    datatype: noyesradio
    default: False
  - What country is associated with the best contact phone number?: Main_app_phone_country
    code: countries_list()
    show if: Main_app_phone_international
  - What is the best contact phone number?: Main_app_phone_number
validation code: |
  if Main_app_phone_international:
    if not phone_number_is_valid(Main_app_phone_number, country=Main_app_phone_country):
      validation_error('Please enter a valid phone number for ' + country_name(Main_app_phone_country) + '.', field='phone_number')
  else:
    if not phone_number_is_valid(Main_app_phone_number):
      validation_error('Please enter a valid phone number.', field='Main_app_phone_number')
---
#This asks for more details from the main applicant
question: Main Applicant's Visa Details
subquestion: |
  Please fill out the Main Applicant's Visa Details information below.
fields:
  - Does the Main Applicant hold a Current Australian Visa: M_aus_visa
    datatype: radio
    choices:
      - Yes
      - No
  - What is the type of Visa held by the Main Applicant: M_visa_type
    datatype: area
  - What is the main purpose of the Main Applicant's stay in Australia: M_reason_stay
    datatype: area
---